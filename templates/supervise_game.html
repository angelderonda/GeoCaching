{% extends 'base.html' %}

{% block content %}



<div class="row">
    <div class="col">
        <h2> Supervise your game!</h2>
        <h4>Game: {{ game.name}}</h4>

        {% if game.winner == '' %}
        <h4>Game state: in progress</h4>
        {% else %}
        <h4>Game state: finished</h4>
        <h4>Winner: {{game.winner}}</h4>
        {% endif %}
        <script>var center = '{{ game.location}}'; var zoom = '{{game.zoom}}'; var caches_list = '{{ game.caches|tojson}}' </script>
        <form class="form-label" method="post" action="{{url_for('reset_game')}}">
            <input type="hidden" name="game_id" value="{{game._id}}">
            <input type="submit" value="Reset Game" class="btn_submit theme-d2 hover-d1 hover-border-theme">
        </form>
    </div>

    <div class="col">
    </div>
</div>
<div class="row">
    <div class="col">
        <div class="card Cinfo" >
            <div class="card-header">
                <a class="collapsed btn" data-bs-toggle="collapse">
                    Cache Information
                </a>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th style="width:45%">Name</th>
                        <th style="width:55%">Hints</th>
                    </tr>
                </thead>
                <tbody>
                    {% for cache in game.caches %}
                    <tr>
                        <td>{{ cache.name }}</td>
                        <td>{{ cache.hint }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="col">
        <div class="card Pinfo">
            <div class="card-header">
                <a class="btn" data-bs-toggle="collapse">
                    Player Information
                </a>
            </div>
            <table class="table" >
                <thead>
                    <tr>
                        <th style="width:60%">User Name</th>
                        <th style="width:20%; text-align: center;"># Caches Found</th>
                        <th style="width:20%; text-align: center;">View Caches</th>
                    </tr>
                </thead>
                <tbody>
                    {% for player in in_game %}
                    <tr>
                        <td>{{ player.name }}</td>
                        <td style="text-align: center;"> {{player.cachesCount}}</td>
                        <td style="text-align: center;">
                            <form method="post" action="{{url_for('view_caches')}}">
                                <input type="hidden" name="game_id" value="{{player.game}}">
                                <input type="hidden" name="user_id" value="{{player.user}}">
                                <input type="submit" value="Caches">
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div id="map_view"
            style="height: 450px;width: 100%; padding-left: 60px; padding-right: 60px; padding-top: 20px;"></div>
    </div>
</div>

<script src="./static/map_game.js"></script>

{% endblock %}