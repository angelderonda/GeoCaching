{% extends 'base.html' %}

{% block content %}

<h1> Supervise your game!</h1>

<div class="row">
    <div class="col">
        <div id="map_view" class="map"></div>
    </div>


    <div class="col">

        <div class="row">
            <div class="col">
                <h3 style="margin-right: 120px;">Game: {{ game.name}}</h3>
            </div>
            <div class="col">
                {% if game.winner == '' %}
                <h3>Game in progress...</h3>
                {% else %}
                <h3>Winner: {{game.winner}}</h3>
                {% endif %}
                <script>var center = '{{ game.location}}'; var zoom = '{{game.zoom}}'; var caches_list = '{{ game.caches|tojson}}' </script>
            </div>
        </div>


        <div class="card Cinfo">
            <div class="card-header">
                <a class="collapsed btn" data-bs-toggle="collapse">
                    Cache Information
                </a>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th style="width:45%">Name</th>
                        <th style="width:55%">Hints</th>
                    </tr>
                </thead>
                <tbody>
                    {% for cache in game.caches %}
                    <tr>
                        <td>{{ cache.name }}</td>
                        <td>{{ cache.hint }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="card Pinfo" >
            <div class="card-header">
                <a class="btn" data-bs-toggle="collapse">
                    Players
                </a>
            </div>
            <table class="table" style="width:100%">
                <thead>
                    <tr>
                        <th style="width:60%">User Name</th>
                        <th style="width:20%; text-align: center;"># Caches Found</th>
                        <th style="width:20%; text-align: center;">View Caches</th>
                    </tr>
                </thead>
                <tbody>
                    {% for player in in_game %}
                    <tr>
                        <td>{{ player.name }}</td>
                        <td style="text-align: center;"> {{player.cachesCount}}</td>
                        <td style="text-align: center;">
                            <form method="post" action="{{url_for('view_caches')}}">
                                <input type="hidden" name="game_id" value="{{player.game}}">
                                <input type="hidden" name="user_id" value="{{player.user}}">
                                <input type="submit" value="Caches">
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>

        <form method="post" action="{{url_for('reset_game')}}">
            <input type="hidden" name="game_id" value="{{game._id}}">
            <input type="submit" value="Reset Game" class="button button2">
        </form>
    </div>
</div>

<script src="./static/map_game.js"></script>

{% endblock %}